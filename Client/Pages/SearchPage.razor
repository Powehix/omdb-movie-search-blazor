@using OMDbMovieSearch.Client.Services;
@using OMDbMovieSearch.Shared.Models;

@page "/"
@inject MovieApiService MovieApi

<h3>Movie Search</h3>

<input @bind="searchText" placeholder="Enter movie title" />
<button @onclick="Search">Search</button>

@if (results is not null)
{
    <ul>
        @foreach (var movie in results)
        {
            <li>
                <a href="movie/@movie.imdbID">@movie.Title (@movie.Year)</a>
            </li>
        }
    </ul>
}

@code {
    private string searchText;
    private List<MovieSearchResult>? results;

    private async Task Search()
    {
        if (!string.IsNullOrWhiteSpace(searchText))
        {
            results = await MovieApi.SearchMoviesAsync(searchText);
        }
    }
}